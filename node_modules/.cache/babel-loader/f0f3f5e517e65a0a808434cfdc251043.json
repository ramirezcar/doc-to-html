{"ast":null,"code":"var _ = require(\"underscore\");\n\nexports.readNumberingXml = readNumberingXml;\nexports.Numbering = Numbering;\nexports.defaultNumbering = new Numbering({}, {});\n\nfunction Numbering(nums, abstractNums, styles) {\n  var allLevels = _.flatten(_.values(abstractNums).map(function (abstractNum) {\n    return _.values(abstractNum.levels);\n  }));\n\n  var levelsByParagraphStyleId = _.indexBy(allLevels.filter(function (level) {\n    return level.paragraphStyleId != null;\n  }), \"paragraphStyleId\");\n\n  function findLevel(numId, level) {\n    var num = nums[numId];\n\n    if (num) {\n      var abstractNum = abstractNums[num.abstractNumId];\n\n      if (!abstractNum) {\n        return null;\n      } else if (abstractNum.numStyleLink == null) {\n        return abstractNums[num.abstractNumId].levels[level];\n      } else {\n        var style = styles.findNumberingStyleById(abstractNum.numStyleLink);\n        return findLevel(style.numId, level);\n      }\n    } else {\n      return null;\n    }\n  }\n\n  function findLevelByParagraphStyleId(styleId) {\n    return levelsByParagraphStyleId[styleId] || null;\n  }\n\n  return {\n    findLevel: findLevel,\n    findLevelByParagraphStyleId: findLevelByParagraphStyleId\n  };\n}\n\nfunction readNumberingXml(root, options) {\n  if (!options || !options.styles) {\n    throw new Error(\"styles is missing\");\n  }\n\n  var abstractNums = readAbstractNums(root);\n  var nums = readNums(root, abstractNums);\n  return new Numbering(nums, abstractNums, options.styles);\n}\n\nfunction readAbstractNums(root) {\n  var abstractNums = {};\n  root.getElementsByTagName(\"w:abstractNum\").forEach(function (element) {\n    var id = element.attributes[\"w:abstractNumId\"];\n    abstractNums[id] = readAbstractNum(element);\n  });\n  return abstractNums;\n}\n\nfunction readAbstractNum(element) {\n  var levels = {};\n  element.getElementsByTagName(\"w:lvl\").forEach(function (levelElement) {\n    var levelIndex = levelElement.attributes[\"w:ilvl\"];\n    var numFmt = levelElement.first(\"w:numFmt\").attributes[\"w:val\"];\n    var paragraphStyleId = levelElement.firstOrEmpty(\"w:pStyle\").attributes[\"w:val\"];\n    levels[levelIndex] = {\n      isOrdered: numFmt !== \"bullet\",\n      level: levelIndex,\n      paragraphStyleId: paragraphStyleId\n    };\n  });\n  var numStyleLink = element.firstOrEmpty(\"w:numStyleLink\").attributes[\"w:val\"];\n  return {\n    levels: levels,\n    numStyleLink: numStyleLink\n  };\n}\n\nfunction readNums(root) {\n  var nums = {};\n  root.getElementsByTagName(\"w:num\").forEach(function (element) {\n    var numId = element.attributes[\"w:numId\"];\n    var abstractNumId = element.first(\"w:abstractNumId\").attributes[\"w:val\"];\n    nums[numId] = {\n      abstractNumId: abstractNumId\n    };\n  });\n  return nums;\n}","map":{"version":3,"sources":["C:/Users/Carlos/Desktop/Coding/doc-to-html/node_modules/mammoth/lib/docx/numbering-xml.js"],"names":["_","require","exports","readNumberingXml","Numbering","defaultNumbering","nums","abstractNums","styles","allLevels","flatten","values","map","abstractNum","levels","levelsByParagraphStyleId","indexBy","filter","level","paragraphStyleId","findLevel","numId","num","abstractNumId","numStyleLink","style","findNumberingStyleById","findLevelByParagraphStyleId","styleId","root","options","Error","readAbstractNums","readNums","getElementsByTagName","forEach","element","id","attributes","readAbstractNum","levelElement","levelIndex","numFmt","first","firstOrEmpty","isOrdered"],"mappings":"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","sourcesContent":["var _ = require(\"underscore\");\n\nexports.readNumberingXml = readNumberingXml;\nexports.Numbering = Numbering;\nexports.defaultNumbering = new Numbering({}, {});\n\nfunction Numbering(nums, abstractNums, styles) {\n    var allLevels = _.flatten(_.values(abstractNums).map(function(abstractNum) {\n        return _.values(abstractNum.levels);\n    }));\n\n    var levelsByParagraphStyleId = _.indexBy(\n        allLevels.filter(function(level) {\n            return level.paragraphStyleId != null;\n        }),\n        \"paragraphStyleId\"\n    );\n\n    function findLevel(numId, level) {\n        var num = nums[numId];\n        if (num) {\n            var abstractNum = abstractNums[num.abstractNumId];\n            if (!abstractNum) {\n                return null;\n            } else if (abstractNum.numStyleLink == null) {\n                return abstractNums[num.abstractNumId].levels[level];\n            } else {\n                var style = styles.findNumberingStyleById(abstractNum.numStyleLink);\n                return findLevel(style.numId, level);\n            }\n        } else {\n            return null;\n        }\n    }\n\n    function findLevelByParagraphStyleId(styleId) {\n        return levelsByParagraphStyleId[styleId] || null;\n    }\n\n    return {\n        findLevel: findLevel,\n        findLevelByParagraphStyleId: findLevelByParagraphStyleId\n    };\n}\n\nfunction readNumberingXml(root, options) {\n    if (!options || !options.styles) {\n        throw new Error(\"styles is missing\");\n    }\n\n    var abstractNums = readAbstractNums(root);\n    var nums = readNums(root, abstractNums);\n    return new Numbering(nums, abstractNums, options.styles);\n}\n\nfunction readAbstractNums(root) {\n    var abstractNums = {};\n    root.getElementsByTagName(\"w:abstractNum\").forEach(function(element) {\n        var id = element.attributes[\"w:abstractNumId\"];\n        abstractNums[id] = readAbstractNum(element);\n    });\n    return abstractNums;\n}\n\nfunction readAbstractNum(element) {\n    var levels = {};\n    element.getElementsByTagName(\"w:lvl\").forEach(function(levelElement) {\n        var levelIndex = levelElement.attributes[\"w:ilvl\"];\n        var numFmt = levelElement.first(\"w:numFmt\").attributes[\"w:val\"];\n        var paragraphStyleId = levelElement.firstOrEmpty(\"w:pStyle\").attributes[\"w:val\"];\n\n        levels[levelIndex] = {\n            isOrdered: numFmt !== \"bullet\",\n            level: levelIndex,\n            paragraphStyleId: paragraphStyleId\n        };\n    });\n\n    var numStyleLink = element.firstOrEmpty(\"w:numStyleLink\").attributes[\"w:val\"];\n\n    return {levels: levels, numStyleLink: numStyleLink};\n}\n\nfunction readNums(root) {\n    var nums = {};\n    root.getElementsByTagName(\"w:num\").forEach(function(element) {\n        var numId = element.attributes[\"w:numId\"];\n        var abstractNumId = element.first(\"w:abstractNumId\").attributes[\"w:val\"];\n        nums[numId] = {abstractNumId: abstractNumId};\n    });\n    return nums;\n}\n"]},"metadata":{},"sourceType":"script"}