{"ast":null,"code":"var _ = require(\"underscore\");\n\nvar xmlbuilder = require(\"xmlbuilder\");\n\nexports.writeString = writeString;\n\nfunction writeString(root, namespaces) {\n  var uriToPrefix = _.invert(namespaces);\n\n  var nodeWriters = {\n    element: writeElement,\n    text: writeTextNode\n  };\n\n  function writeNode(builder, node) {\n    return nodeWriters[node.type](builder, node);\n  }\n\n  function writeElement(builder, element) {\n    var elementBuilder = builder.element(mapElementName(element.name), element.attributes);\n    element.children.forEach(function (child) {\n      writeNode(elementBuilder, child);\n    });\n  }\n\n  function mapElementName(name) {\n    var longFormMatch = /^\\{(.*)\\}(.*)$/.exec(name);\n\n    if (longFormMatch) {\n      var prefix = uriToPrefix[longFormMatch[1]];\n      return prefix + (prefix === \"\" ? \"\" : \":\") + longFormMatch[2];\n    } else {\n      return name;\n    }\n  }\n\n  function writeDocument(root) {\n    var builder = xmlbuilder.create(mapElementName(root.name), {\n      version: '1.0',\n      encoding: 'UTF-8',\n      standalone: true\n    });\n\n    _.forEach(namespaces, function (uri, prefix) {\n      var key = \"xmlns\" + (prefix === \"\" ? \"\" : \":\" + prefix);\n      builder.attribute(key, uri);\n    });\n\n    root.children.forEach(function (child) {\n      writeNode(builder, child);\n    });\n    return builder.end();\n  }\n\n  return writeDocument(root);\n}\n\nfunction writeTextNode(builder, node) {\n  builder.text(node.value);\n}","map":{"version":3,"sources":["C:/Users/Carlos/Desktop/Coding/doc-to-html/node_modules/mammoth/lib/xml/writer.js"],"names":["_","require","xmlbuilder","exports","writeString","root","namespaces","uriToPrefix","invert","nodeWriters","element","writeElement","text","writeTextNode","writeNode","builder","node","type","elementBuilder","mapElementName","name","attributes","children","forEach","child","longFormMatch","exec","prefix","writeDocument","create","version","encoding","standalone","uri","key","attribute","end","value"],"mappings":"AAAA,IAAIA,CAAC,GAAGC,OAAO,CAAC,YAAD,CAAf;;AACA,IAAIC,UAAU,GAAGD,OAAO,CAAC,YAAD,CAAxB;;AAGAE,OAAO,CAACC,WAAR,GAAsBA,WAAtB;;AAGA,SAASA,WAAT,CAAqBC,IAArB,EAA2BC,UAA3B,EAAuC;AACnC,MAAIC,WAAW,GAAGP,CAAC,CAACQ,MAAF,CAASF,UAAT,CAAlB;;AAEA,MAAIG,WAAW,GAAG;AACdC,IAAAA,OAAO,EAAEC,YADK;AAEdC,IAAAA,IAAI,EAAEC;AAFQ,GAAlB;;AAKA,WAASC,SAAT,CAAmBC,OAAnB,EAA4BC,IAA5B,EAAkC;AAC9B,WAAOP,WAAW,CAACO,IAAI,CAACC,IAAN,CAAX,CAAuBF,OAAvB,EAAgCC,IAAhC,CAAP;AACH;;AAED,WAASL,YAAT,CAAsBI,OAAtB,EAA+BL,OAA/B,EAAwC;AACpC,QAAIQ,cAAc,GAAGH,OAAO,CAACL,OAAR,CAAgBS,cAAc,CAACT,OAAO,CAACU,IAAT,CAA9B,EAA8CV,OAAO,CAACW,UAAtD,CAArB;AACAX,IAAAA,OAAO,CAACY,QAAR,CAAiBC,OAAjB,CAAyB,UAASC,KAAT,EAAgB;AACrCV,MAAAA,SAAS,CAACI,cAAD,EAAiBM,KAAjB,CAAT;AACH,KAFD;AAGH;;AAED,WAASL,cAAT,CAAwBC,IAAxB,EAA8B;AAC1B,QAAIK,aAAa,GAAG,iBAAiBC,IAAjB,CAAsBN,IAAtB,CAApB;;AACA,QAAIK,aAAJ,EAAmB;AACf,UAAIE,MAAM,GAAGpB,WAAW,CAACkB,aAAa,CAAC,CAAD,CAAd,CAAxB;AACA,aAAOE,MAAM,IAAIA,MAAM,KAAK,EAAX,GAAgB,EAAhB,GAAqB,GAAzB,CAAN,GAAsCF,aAAa,CAAC,CAAD,CAA1D;AACH,KAHD,MAGO;AACH,aAAOL,IAAP;AACH;AACJ;;AAED,WAASQ,aAAT,CAAuBvB,IAAvB,EAA6B;AACzB,QAAIU,OAAO,GAAGb,UAAU,CACnB2B,MADS,CACFV,cAAc,CAACd,IAAI,CAACe,IAAN,CADZ,EACyB;AAC/BU,MAAAA,OAAO,EAAE,KADsB;AAE/BC,MAAAA,QAAQ,EAAE,OAFqB;AAG/BC,MAAAA,UAAU,EAAE;AAHmB,KADzB,CAAd;;AAOAhC,IAAAA,CAAC,CAACuB,OAAF,CAAUjB,UAAV,EAAsB,UAAS2B,GAAT,EAAcN,MAAd,EAAsB;AACxC,UAAIO,GAAG,GAAG,WAAWP,MAAM,KAAK,EAAX,GAAgB,EAAhB,GAAqB,MAAMA,MAAtC,CAAV;AACAZ,MAAAA,OAAO,CAACoB,SAAR,CAAkBD,GAAlB,EAAuBD,GAAvB;AACH,KAHD;;AAKA5B,IAAAA,IAAI,CAACiB,QAAL,CAAcC,OAAd,CAAsB,UAASC,KAAT,EAAgB;AAClCV,MAAAA,SAAS,CAACC,OAAD,EAAUS,KAAV,CAAT;AACH,KAFD;AAGA,WAAOT,OAAO,CAACqB,GAAR,EAAP;AACH;;AAED,SAAOR,aAAa,CAACvB,IAAD,CAApB;AACH;;AAED,SAASQ,aAAT,CAAuBE,OAAvB,EAAgCC,IAAhC,EAAsC;AAClCD,EAAAA,OAAO,CAACH,IAAR,CAAaI,IAAI,CAACqB,KAAlB;AACH","sourcesContent":["var _ = require(\"underscore\");\nvar xmlbuilder = require(\"xmlbuilder\");\n\n\nexports.writeString = writeString;\n\n\nfunction writeString(root, namespaces) {\n    var uriToPrefix = _.invert(namespaces);\n    \n    var nodeWriters = {\n        element: writeElement,\n        text: writeTextNode\n    };\n\n    function writeNode(builder, node) {\n        return nodeWriters[node.type](builder, node);\n    }\n\n    function writeElement(builder, element) {\n        var elementBuilder = builder.element(mapElementName(element.name), element.attributes);\n        element.children.forEach(function(child) {\n            writeNode(elementBuilder, child);\n        });\n    }\n    \n    function mapElementName(name) {\n        var longFormMatch = /^\\{(.*)\\}(.*)$/.exec(name);\n        if (longFormMatch) {\n            var prefix = uriToPrefix[longFormMatch[1]];\n            return prefix + (prefix === \"\" ? \"\" : \":\") + longFormMatch[2];\n        } else {\n            return name;\n        }\n    }\n    \n    function writeDocument(root) {\n        var builder = xmlbuilder\n            .create(mapElementName(root.name), {\n                version: '1.0',\n                encoding: 'UTF-8',\n                standalone: true\n            });\n        \n        _.forEach(namespaces, function(uri, prefix) {\n            var key = \"xmlns\" + (prefix === \"\" ? \"\" : \":\" + prefix);\n            builder.attribute(key, uri);\n        });\n        \n        root.children.forEach(function(child) {\n            writeNode(builder, child);\n        });\n        return builder.end();\n    }\n\n    return writeDocument(root);\n}\n\nfunction writeTextNode(builder, node) {\n    builder.text(node.value);\n}\n"]},"metadata":{},"sourceType":"script"}