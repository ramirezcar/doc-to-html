{"ast":null,"code":"\"use strict\";\n\nmodule.exports = function (Promise, apiRejection, INTERNAL, tryConvertToPromise, Proxyable, debug) {\n  var errors = require(\"./errors\");\n\n  var TypeError = errors.TypeError;\n\n  var util = require(\"./util\");\n\n  var errorObj = util.errorObj;\n  var tryCatch = util.tryCatch;\n  var yieldHandlers = [];\n\n  function promiseFromYieldHandler(value, yieldHandlers, traceParent) {\n    for (var i = 0; i < yieldHandlers.length; ++i) {\n      traceParent._pushContext();\n\n      var result = tryCatch(yieldHandlers[i])(value);\n\n      traceParent._popContext();\n\n      if (result === errorObj) {\n        traceParent._pushContext();\n\n        var ret = Promise.reject(errorObj.e);\n\n        traceParent._popContext();\n\n        return ret;\n      }\n\n      var maybePromise = tryConvertToPromise(result, traceParent);\n      if (maybePromise instanceof Promise) return maybePromise;\n    }\n\n    return null;\n  }\n\n  function PromiseSpawn(generatorFunction, receiver, yieldHandler, stack) {\n    if (debug.cancellation()) {\n      var internal = new Promise(INTERNAL);\n\n      var _finallyPromise = this._finallyPromise = new Promise(INTERNAL);\n\n      this._promise = internal.lastly(function () {\n        return _finallyPromise;\n      });\n\n      internal._captureStackTrace();\n\n      internal._setOnCancel(this);\n    } else {\n      var promise = this._promise = new Promise(INTERNAL);\n\n      promise._captureStackTrace();\n    }\n\n    this._stack = stack;\n    this._generatorFunction = generatorFunction;\n    this._receiver = receiver;\n    this._generator = undefined;\n    this._yieldHandlers = typeof yieldHandler === \"function\" ? [yieldHandler].concat(yieldHandlers) : yieldHandlers;\n    this._yieldedPromise = null;\n    this._cancellationPhase = false;\n  }\n\n  util.inherits(PromiseSpawn, Proxyable);\n\n  PromiseSpawn.prototype._isResolved = function () {\n    return this._promise === null;\n  };\n\n  PromiseSpawn.prototype._cleanup = function () {\n    this._promise = this._generator = null;\n\n    if (debug.cancellation() && this._finallyPromise !== null) {\n      this._finallyPromise._fulfill();\n\n      this._finallyPromise = null;\n    }\n  };\n\n  PromiseSpawn.prototype._promiseCancelled = function () {\n    if (this._isResolved()) return;\n    var implementsReturn = typeof this._generator[\"return\"] !== \"undefined\";\n    var result;\n\n    if (!implementsReturn) {\n      var reason = new Promise.CancellationError(\"generator .return() sentinel\");\n      Promise.coroutine.returnSentinel = reason;\n\n      this._promise._attachExtraTrace(reason);\n\n      this._promise._pushContext();\n\n      result = tryCatch(this._generator[\"throw\"]).call(this._generator, reason);\n\n      this._promise._popContext();\n    } else {\n      this._promise._pushContext();\n\n      result = tryCatch(this._generator[\"return\"]).call(this._generator, undefined);\n\n      this._promise._popContext();\n    }\n\n    this._cancellationPhase = true;\n    this._yieldedPromise = null;\n\n    this._continue(result);\n  };\n\n  PromiseSpawn.prototype._promiseFulfilled = function (value) {\n    this._yieldedPromise = null;\n\n    this._promise._pushContext();\n\n    var result = tryCatch(this._generator.next).call(this._generator, value);\n\n    this._promise._popContext();\n\n    this._continue(result);\n  };\n\n  PromiseSpawn.prototype._promiseRejected = function (reason) {\n    this._yieldedPromise = null;\n\n    this._promise._attachExtraTrace(reason);\n\n    this._promise._pushContext();\n\n    var result = tryCatch(this._generator[\"throw\"]).call(this._generator, reason);\n\n    this._promise._popContext();\n\n    this._continue(result);\n  };\n\n  PromiseSpawn.prototype._resultCancelled = function () {\n    if (this._yieldedPromise instanceof Promise) {\n      var promise = this._yieldedPromise;\n      this._yieldedPromise = null;\n      promise.cancel();\n    }\n  };\n\n  PromiseSpawn.prototype.promise = function () {\n    return this._promise;\n  };\n\n  PromiseSpawn.prototype._run = function () {\n    this._generator = this._generatorFunction.call(this._receiver);\n    this._receiver = this._generatorFunction = undefined;\n\n    this._promiseFulfilled(undefined);\n  };\n\n  PromiseSpawn.prototype._continue = function (result) {\n    var promise = this._promise;\n\n    if (result === errorObj) {\n      this._cleanup();\n\n      if (this._cancellationPhase) {\n        return promise.cancel();\n      } else {\n        return promise._rejectCallback(result.e, false);\n      }\n    }\n\n    var value = result.value;\n\n    if (result.done === true) {\n      this._cleanup();\n\n      if (this._cancellationPhase) {\n        return promise.cancel();\n      } else {\n        return promise._resolveCallback(value);\n      }\n    } else {\n      var maybePromise = tryConvertToPromise(value, this._promise);\n\n      if (!(maybePromise instanceof Promise)) {\n        maybePromise = promiseFromYieldHandler(maybePromise, this._yieldHandlers, this._promise);\n\n        if (maybePromise === null) {\n          this._promiseRejected(new TypeError(\"A value %s was yielded that could not be treated as a promise\\n\\n    See http://goo.gl/MqrFmX\\n\\n\".replace(\"%s\", value) + \"From coroutine:\\n\" + this._stack.split(\"\\n\").slice(1, -7).join(\"\\n\")));\n\n          return;\n        }\n      }\n\n      maybePromise = maybePromise._target();\n      var bitField = maybePromise._bitField;\n      ;\n\n      if ((bitField & 50397184) === 0) {\n        this._yieldedPromise = maybePromise;\n\n        maybePromise._proxy(this, null);\n      } else if ((bitField & 33554432) !== 0) {\n        Promise._async.invoke(this._promiseFulfilled, this, maybePromise._value());\n      } else if ((bitField & 16777216) !== 0) {\n        Promise._async.invoke(this._promiseRejected, this, maybePromise._reason());\n      } else {\n        this._promiseCancelled();\n      }\n    }\n  };\n\n  Promise.coroutine = function (generatorFunction, options) {\n    if (typeof generatorFunction !== \"function\") {\n      throw new TypeError(\"generatorFunction must be a function\\n\\n    See http://goo.gl/MqrFmX\\n\");\n    }\n\n    var yieldHandler = Object(options).yieldHandler;\n    var PromiseSpawn$ = PromiseSpawn;\n    var stack = new Error().stack;\n    return function () {\n      var generator = generatorFunction.apply(this, arguments);\n      var spawn = new PromiseSpawn$(undefined, undefined, yieldHandler, stack);\n      var ret = spawn.promise();\n      spawn._generator = generator;\n\n      spawn._promiseFulfilled(undefined);\n\n      return ret;\n    };\n  };\n\n  Promise.coroutine.addYieldHandler = function (fn) {\n    if (typeof fn !== \"function\") {\n      throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n\n    yieldHandlers.push(fn);\n  };\n\n  Promise.spawn = function (generatorFunction) {\n    debug.deprecated(\"Promise.spawn()\", \"Promise.coroutine()\");\n\n    if (typeof generatorFunction !== \"function\") {\n      return apiRejection(\"generatorFunction must be a function\\n\\n    See http://goo.gl/MqrFmX\\n\");\n    }\n\n    var spawn = new PromiseSpawn(generatorFunction, this);\n    var ret = spawn.promise();\n\n    spawn._run(Promise.spawn);\n\n    return ret;\n  };\n};","map":{"version":3,"sources":["C:/Users/Carlos/Desktop/Coding/doc-to-html/node_modules/bluebird/js/release/generators.js"],"names":["module","exports","Promise","apiRejection","INTERNAL","tryConvertToPromise","Proxyable","debug","errors","require","TypeError","util","errorObj","tryCatch","yieldHandlers","promiseFromYieldHandler","value","traceParent","i","length","_pushContext","result","_popContext","ret","reject","e","maybePromise","PromiseSpawn","generatorFunction","receiver","yieldHandler","stack","cancellation","internal","_finallyPromise","_promise","lastly","_captureStackTrace","_setOnCancel","promise","_stack","_generatorFunction","_receiver","_generator","undefined","_yieldHandlers","concat","_yieldedPromise","_cancellationPhase","inherits","prototype","_isResolved","_cleanup","_fulfill","_promiseCancelled","implementsReturn","reason","CancellationError","coroutine","returnSentinel","_attachExtraTrace","call","_continue","_promiseFulfilled","next","_promiseRejected","_resultCancelled","cancel","_run","_rejectCallback","done","_resolveCallback","replace","split","slice","join","_target","bitField","_bitField","_proxy","_async","invoke","_value","_reason","options","Object","PromiseSpawn$","Error","generator","apply","arguments","spawn","addYieldHandler","fn","classString","push","deprecated"],"mappings":"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","sourcesContent":["\"use strict\";\nmodule.exports = function(Promise,\n                          apiRejection,\n                          INTERNAL,\n                          tryConvertToPromise,\n                          Proxyable,\n                          debug) {\nvar errors = require(\"./errors\");\nvar TypeError = errors.TypeError;\nvar util = require(\"./util\");\nvar errorObj = util.errorObj;\nvar tryCatch = util.tryCatch;\nvar yieldHandlers = [];\n\nfunction promiseFromYieldHandler(value, yieldHandlers, traceParent) {\n    for (var i = 0; i < yieldHandlers.length; ++i) {\n        traceParent._pushContext();\n        var result = tryCatch(yieldHandlers[i])(value);\n        traceParent._popContext();\n        if (result === errorObj) {\n            traceParent._pushContext();\n            var ret = Promise.reject(errorObj.e);\n            traceParent._popContext();\n            return ret;\n        }\n        var maybePromise = tryConvertToPromise(result, traceParent);\n        if (maybePromise instanceof Promise) return maybePromise;\n    }\n    return null;\n}\n\nfunction PromiseSpawn(generatorFunction, receiver, yieldHandler, stack) {\n    if (debug.cancellation()) {\n        var internal = new Promise(INTERNAL);\n        var _finallyPromise = this._finallyPromise = new Promise(INTERNAL);\n        this._promise = internal.lastly(function() {\n            return _finallyPromise;\n        });\n        internal._captureStackTrace();\n        internal._setOnCancel(this);\n    } else {\n        var promise = this._promise = new Promise(INTERNAL);\n        promise._captureStackTrace();\n    }\n    this._stack = stack;\n    this._generatorFunction = generatorFunction;\n    this._receiver = receiver;\n    this._generator = undefined;\n    this._yieldHandlers = typeof yieldHandler === \"function\"\n        ? [yieldHandler].concat(yieldHandlers)\n        : yieldHandlers;\n    this._yieldedPromise = null;\n    this._cancellationPhase = false;\n}\nutil.inherits(PromiseSpawn, Proxyable);\n\nPromiseSpawn.prototype._isResolved = function() {\n    return this._promise === null;\n};\n\nPromiseSpawn.prototype._cleanup = function() {\n    this._promise = this._generator = null;\n    if (debug.cancellation() && this._finallyPromise !== null) {\n        this._finallyPromise._fulfill();\n        this._finallyPromise = null;\n    }\n};\n\nPromiseSpawn.prototype._promiseCancelled = function() {\n    if (this._isResolved()) return;\n    var implementsReturn = typeof this._generator[\"return\"] !== \"undefined\";\n\n    var result;\n    if (!implementsReturn) {\n        var reason = new Promise.CancellationError(\n            \"generator .return() sentinel\");\n        Promise.coroutine.returnSentinel = reason;\n        this._promise._attachExtraTrace(reason);\n        this._promise._pushContext();\n        result = tryCatch(this._generator[\"throw\"]).call(this._generator,\n                                                         reason);\n        this._promise._popContext();\n    } else {\n        this._promise._pushContext();\n        result = tryCatch(this._generator[\"return\"]).call(this._generator,\n                                                          undefined);\n        this._promise._popContext();\n    }\n    this._cancellationPhase = true;\n    this._yieldedPromise = null;\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._promiseFulfilled = function(value) {\n    this._yieldedPromise = null;\n    this._promise._pushContext();\n    var result = tryCatch(this._generator.next).call(this._generator, value);\n    this._promise._popContext();\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._promiseRejected = function(reason) {\n    this._yieldedPromise = null;\n    this._promise._attachExtraTrace(reason);\n    this._promise._pushContext();\n    var result = tryCatch(this._generator[\"throw\"])\n        .call(this._generator, reason);\n    this._promise._popContext();\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._resultCancelled = function() {\n    if (this._yieldedPromise instanceof Promise) {\n        var promise = this._yieldedPromise;\n        this._yieldedPromise = null;\n        promise.cancel();\n    }\n};\n\nPromiseSpawn.prototype.promise = function () {\n    return this._promise;\n};\n\nPromiseSpawn.prototype._run = function () {\n    this._generator = this._generatorFunction.call(this._receiver);\n    this._receiver =\n        this._generatorFunction = undefined;\n    this._promiseFulfilled(undefined);\n};\n\nPromiseSpawn.prototype._continue = function (result) {\n    var promise = this._promise;\n    if (result === errorObj) {\n        this._cleanup();\n        if (this._cancellationPhase) {\n            return promise.cancel();\n        } else {\n            return promise._rejectCallback(result.e, false);\n        }\n    }\n\n    var value = result.value;\n    if (result.done === true) {\n        this._cleanup();\n        if (this._cancellationPhase) {\n            return promise.cancel();\n        } else {\n            return promise._resolveCallback(value);\n        }\n    } else {\n        var maybePromise = tryConvertToPromise(value, this._promise);\n        if (!(maybePromise instanceof Promise)) {\n            maybePromise =\n                promiseFromYieldHandler(maybePromise,\n                                        this._yieldHandlers,\n                                        this._promise);\n            if (maybePromise === null) {\n                this._promiseRejected(\n                    new TypeError(\n                        \"A value %s was yielded that could not be treated as a promise\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\\u000a\".replace(\"%s\", value) +\n                        \"From coroutine:\\u000a\" +\n                        this._stack.split(\"\\n\").slice(1, -7).join(\"\\n\")\n                    )\n                );\n                return;\n            }\n        }\n        maybePromise = maybePromise._target();\n        var bitField = maybePromise._bitField;\n        ;\n        if (((bitField & 50397184) === 0)) {\n            this._yieldedPromise = maybePromise;\n            maybePromise._proxy(this, null);\n        } else if (((bitField & 33554432) !== 0)) {\n            Promise._async.invoke(\n                this._promiseFulfilled, this, maybePromise._value()\n            );\n        } else if (((bitField & 16777216) !== 0)) {\n            Promise._async.invoke(\n                this._promiseRejected, this, maybePromise._reason()\n            );\n        } else {\n            this._promiseCancelled();\n        }\n    }\n};\n\nPromise.coroutine = function (generatorFunction, options) {\n    if (typeof generatorFunction !== \"function\") {\n        throw new TypeError(\"generatorFunction must be a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var yieldHandler = Object(options).yieldHandler;\n    var PromiseSpawn$ = PromiseSpawn;\n    var stack = new Error().stack;\n    return function () {\n        var generator = generatorFunction.apply(this, arguments);\n        var spawn = new PromiseSpawn$(undefined, undefined, yieldHandler,\n                                      stack);\n        var ret = spawn.promise();\n        spawn._generator = generator;\n        spawn._promiseFulfilled(undefined);\n        return ret;\n    };\n};\n\nPromise.coroutine.addYieldHandler = function(fn) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    yieldHandlers.push(fn);\n};\n\nPromise.spawn = function (generatorFunction) {\n    debug.deprecated(\"Promise.spawn()\", \"Promise.coroutine()\");\n    if (typeof generatorFunction !== \"function\") {\n        return apiRejection(\"generatorFunction must be a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var spawn = new PromiseSpawn(generatorFunction, this);\n    var ret = spawn.promise();\n    spawn._run(Promise.spawn);\n    return ret;\n};\n};\n"]},"metadata":{},"sourceType":"script"}