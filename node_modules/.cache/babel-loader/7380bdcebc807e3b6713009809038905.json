{"ast":null,"code":"\"use strict\";\n\nmodule.exports = function () {\n  var makeSelfResolutionError = function makeSelfResolutionError() {\n    return new TypeError(\"circular promise resolution chain\\n\\n    See http://goo.gl/MqrFmX\\n\");\n  };\n\n  var reflectHandler = function reflectHandler() {\n    return new Promise.PromiseInspection(this._target());\n  };\n\n  var apiRejection = function apiRejection(msg) {\n    return Promise.reject(new TypeError(msg));\n  };\n\n  function Proxyable() {}\n\n  var UNDEFINED_BINDING = {};\n\n  var util = require(\"./util\");\n\n  var getDomain;\n\n  if (util.isNode) {\n    getDomain = function getDomain() {\n      var ret = process.domain;\n      if (ret === undefined) ret = null;\n      return ret;\n    };\n  } else {\n    getDomain = function getDomain() {\n      return null;\n    };\n  }\n\n  util.notEnumerableProp(Promise, \"_getDomain\", getDomain);\n\n  var es5 = require(\"./es5\");\n\n  var Async = require(\"./async\");\n\n  var async = new Async();\n  es5.defineProperty(Promise, \"_async\", {\n    value: async\n  });\n\n  var errors = require(\"./errors\");\n\n  var TypeError = Promise.TypeError = errors.TypeError;\n  Promise.RangeError = errors.RangeError;\n  var CancellationError = Promise.CancellationError = errors.CancellationError;\n  Promise.TimeoutError = errors.TimeoutError;\n  Promise.OperationalError = errors.OperationalError;\n  Promise.RejectionError = errors.OperationalError;\n  Promise.AggregateError = errors.AggregateError;\n\n  var INTERNAL = function INTERNAL() {};\n\n  var APPLY = {};\n  var NEXT_FILTER = {};\n\n  var tryConvertToPromise = require(\"./thenables\")(Promise, INTERNAL);\n\n  var PromiseArray = require(\"./promise_array\")(Promise, INTERNAL, tryConvertToPromise, apiRejection, Proxyable);\n\n  var Context = require(\"./context\")(Promise);\n  /*jshint unused:false*/\n\n\n  var createContext = Context.create;\n\n  var debug = require(\"./debuggability\")(Promise, Context);\n\n  var CapturedTrace = debug.CapturedTrace;\n\n  var PassThroughHandlerContext = require(\"./finally\")(Promise, tryConvertToPromise);\n\n  var catchFilter = require(\"./catch_filter\")(NEXT_FILTER);\n\n  var nodebackForPromise = require(\"./nodeback\");\n\n  var errorObj = util.errorObj;\n  var tryCatch = util.tryCatch;\n\n  function check(self, executor) {\n    if (typeof executor !== \"function\") {\n      throw new TypeError(\"expecting a function but got \" + util.classString(executor));\n    }\n\n    if (self.constructor !== Promise) {\n      throw new TypeError(\"the promise constructor cannot be invoked directly\\n\\n    See http://goo.gl/MqrFmX\\n\");\n    }\n  }\n\n  function Promise(executor) {\n    this._bitField = 0;\n    this._fulfillmentHandler0 = undefined;\n    this._rejectionHandler0 = undefined;\n    this._promise0 = undefined;\n    this._receiver0 = undefined;\n\n    if (executor !== INTERNAL) {\n      check(this, executor);\n\n      this._resolveFromExecutor(executor);\n    }\n\n    this._promiseCreated();\n\n    this._fireEvent(\"promiseCreated\", this);\n  }\n\n  Promise.prototype.toString = function () {\n    return \"[object Promise]\";\n  };\n\n  Promise.prototype.caught = Promise.prototype[\"catch\"] = function (fn) {\n    var len = arguments.length;\n\n    if (len > 1) {\n      var catchInstances = new Array(len - 1),\n          j = 0,\n          i;\n\n      for (i = 0; i < len - 1; ++i) {\n        var item = arguments[i];\n\n        if (util.isObject(item)) {\n          catchInstances[j++] = item;\n        } else {\n          return apiRejection(\"expecting an object but got \" + \"A catch statement predicate \" + util.classString(item));\n        }\n      }\n\n      catchInstances.length = j;\n      fn = arguments[i];\n      return this.then(undefined, catchFilter(catchInstances, fn, this));\n    }\n\n    return this.then(undefined, fn);\n  };\n\n  Promise.prototype.reflect = function () {\n    return this._then(reflectHandler, reflectHandler, undefined, this, undefined);\n  };\n\n  Promise.prototype.then = function (didFulfill, didReject) {\n    if (debug.warnings() && arguments.length > 0 && typeof didFulfill !== \"function\" && typeof didReject !== \"function\") {\n      var msg = \".then() only accepts functions but was passed: \" + util.classString(didFulfill);\n\n      if (arguments.length > 1) {\n        msg += \", \" + util.classString(didReject);\n      }\n\n      this._warn(msg);\n    }\n\n    return this._then(didFulfill, didReject, undefined, undefined, undefined);\n  };\n\n  Promise.prototype.done = function (didFulfill, didReject) {\n    var promise = this._then(didFulfill, didReject, undefined, undefined, undefined);\n\n    promise._setIsFinal();\n  };\n\n  Promise.prototype.spread = function (fn) {\n    if (typeof fn !== \"function\") {\n      return apiRejection(\"expecting a function but got \" + util.classString(fn));\n    }\n\n    return this.all()._then(fn, undefined, undefined, APPLY, undefined);\n  };\n\n  Promise.prototype.toJSON = function () {\n    var ret = {\n      isFulfilled: false,\n      isRejected: false,\n      fulfillmentValue: undefined,\n      rejectionReason: undefined\n    };\n\n    if (this.isFulfilled()) {\n      ret.fulfillmentValue = this.value();\n      ret.isFulfilled = true;\n    } else if (this.isRejected()) {\n      ret.rejectionReason = this.reason();\n      ret.isRejected = true;\n    }\n\n    return ret;\n  };\n\n  Promise.prototype.all = function () {\n    if (arguments.length > 0) {\n      this._warn(\".all() was passed arguments but it does not take any\");\n    }\n\n    return new PromiseArray(this).promise();\n  };\n\n  Promise.prototype.error = function (fn) {\n    return this.caught(util.originatesFromRejection, fn);\n  };\n\n  Promise.getNewLibraryCopy = module.exports;\n\n  Promise.is = function (val) {\n    return val instanceof Promise;\n  };\n\n  Promise.fromNode = Promise.fromCallback = function (fn) {\n    var ret = new Promise(INTERNAL);\n\n    ret._captureStackTrace();\n\n    var multiArgs = arguments.length > 1 ? !!Object(arguments[1]).multiArgs : false;\n    var result = tryCatch(fn)(nodebackForPromise(ret, multiArgs));\n\n    if (result === errorObj) {\n      ret._rejectCallback(result.e, true);\n    }\n\n    if (!ret._isFateSealed()) ret._setAsyncGuaranteed();\n    return ret;\n  };\n\n  Promise.all = function (promises) {\n    return new PromiseArray(promises).promise();\n  };\n\n  Promise.cast = function (obj) {\n    var ret = tryConvertToPromise(obj);\n\n    if (!(ret instanceof Promise)) {\n      ret = new Promise(INTERNAL);\n\n      ret._captureStackTrace();\n\n      ret._setFulfilled();\n\n      ret._rejectionHandler0 = obj;\n    }\n\n    return ret;\n  };\n\n  Promise.resolve = Promise.fulfilled = Promise.cast;\n\n  Promise.reject = Promise.rejected = function (reason) {\n    var ret = new Promise(INTERNAL);\n\n    ret._captureStackTrace();\n\n    ret._rejectCallback(reason, true);\n\n    return ret;\n  };\n\n  Promise.setScheduler = function (fn) {\n    if (typeof fn !== \"function\") {\n      throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n\n    return async.setScheduler(fn);\n  };\n\n  Promise.prototype._then = function (didFulfill, didReject, _, receiver, internalData) {\n    var haveInternalData = internalData !== undefined;\n    var promise = haveInternalData ? internalData : new Promise(INTERNAL);\n\n    var target = this._target();\n\n    var bitField = target._bitField;\n\n    if (!haveInternalData) {\n      promise._propagateFrom(this, 3);\n\n      promise._captureStackTrace();\n\n      if (receiver === undefined && (this._bitField & 2097152) !== 0) {\n        if (!((bitField & 50397184) === 0)) {\n          receiver = this._boundValue();\n        } else {\n          receiver = target === this ? undefined : this._boundTo;\n        }\n      }\n\n      this._fireEvent(\"promiseChained\", this, promise);\n    }\n\n    var domain = getDomain();\n\n    if (!((bitField & 50397184) === 0)) {\n      var handler,\n          value,\n          settler = target._settlePromiseCtx;\n\n      if ((bitField & 33554432) !== 0) {\n        value = target._rejectionHandler0;\n        handler = didFulfill;\n      } else if ((bitField & 16777216) !== 0) {\n        value = target._fulfillmentHandler0;\n        handler = didReject;\n\n        target._unsetRejectionIsUnhandled();\n      } else {\n        settler = target._settlePromiseLateCancellationObserver;\n        value = new CancellationError(\"late cancellation observer\");\n\n        target._attachExtraTrace(value);\n\n        handler = didReject;\n      }\n\n      async.invoke(settler, target, {\n        handler: domain === null ? handler : typeof handler === \"function\" && util.domainBind(domain, handler),\n        promise: promise,\n        receiver: receiver,\n        value: value\n      });\n    } else {\n      target._addCallbacks(didFulfill, didReject, promise, receiver, domain);\n    }\n\n    return promise;\n  };\n\n  Promise.prototype._length = function () {\n    return this._bitField & 65535;\n  };\n\n  Promise.prototype._isFateSealed = function () {\n    return (this._bitField & 117506048) !== 0;\n  };\n\n  Promise.prototype._isFollowing = function () {\n    return (this._bitField & 67108864) === 67108864;\n  };\n\n  Promise.prototype._setLength = function (len) {\n    this._bitField = this._bitField & -65536 | len & 65535;\n  };\n\n  Promise.prototype._setFulfilled = function () {\n    this._bitField = this._bitField | 33554432;\n\n    this._fireEvent(\"promiseFulfilled\", this);\n  };\n\n  Promise.prototype._setRejected = function () {\n    this._bitField = this._bitField | 16777216;\n\n    this._fireEvent(\"promiseRejected\", this);\n  };\n\n  Promise.prototype._setFollowing = function () {\n    this._bitField = this._bitField | 67108864;\n\n    this._fireEvent(\"promiseResolved\", this);\n  };\n\n  Promise.prototype._setIsFinal = function () {\n    this._bitField = this._bitField | 4194304;\n  };\n\n  Promise.prototype._isFinal = function () {\n    return (this._bitField & 4194304) > 0;\n  };\n\n  Promise.prototype._unsetCancelled = function () {\n    this._bitField = this._bitField & ~65536;\n  };\n\n  Promise.prototype._setCancelled = function () {\n    this._bitField = this._bitField | 65536;\n\n    this._fireEvent(\"promiseCancelled\", this);\n  };\n\n  Promise.prototype._setWillBeCancelled = function () {\n    this._bitField = this._bitField | 8388608;\n  };\n\n  Promise.prototype._setAsyncGuaranteed = function () {\n    if (async.hasCustomScheduler()) return;\n    this._bitField = this._bitField | 134217728;\n  };\n\n  Promise.prototype._receiverAt = function (index) {\n    var ret = index === 0 ? this._receiver0 : this[index * 4 - 4 + 3];\n\n    if (ret === UNDEFINED_BINDING) {\n      return undefined;\n    } else if (ret === undefined && this._isBound()) {\n      return this._boundValue();\n    }\n\n    return ret;\n  };\n\n  Promise.prototype._promiseAt = function (index) {\n    return this[index * 4 - 4 + 2];\n  };\n\n  Promise.prototype._fulfillmentHandlerAt = function (index) {\n    return this[index * 4 - 4 + 0];\n  };\n\n  Promise.prototype._rejectionHandlerAt = function (index) {\n    return this[index * 4 - 4 + 1];\n  };\n\n  Promise.prototype._boundValue = function () {};\n\n  Promise.prototype._migrateCallback0 = function (follower) {\n    var bitField = follower._bitField;\n    var fulfill = follower._fulfillmentHandler0;\n    var reject = follower._rejectionHandler0;\n    var promise = follower._promise0;\n\n    var receiver = follower._receiverAt(0);\n\n    if (receiver === undefined) receiver = UNDEFINED_BINDING;\n\n    this._addCallbacks(fulfill, reject, promise, receiver, null);\n  };\n\n  Promise.prototype._migrateCallbackAt = function (follower, index) {\n    var fulfill = follower._fulfillmentHandlerAt(index);\n\n    var reject = follower._rejectionHandlerAt(index);\n\n    var promise = follower._promiseAt(index);\n\n    var receiver = follower._receiverAt(index);\n\n    if (receiver === undefined) receiver = UNDEFINED_BINDING;\n\n    this._addCallbacks(fulfill, reject, promise, receiver, null);\n  };\n\n  Promise.prototype._addCallbacks = function (fulfill, reject, promise, receiver, domain) {\n    var index = this._length();\n\n    if (index >= 65535 - 4) {\n      index = 0;\n\n      this._setLength(0);\n    }\n\n    if (index === 0) {\n      this._promise0 = promise;\n      this._receiver0 = receiver;\n\n      if (typeof fulfill === \"function\") {\n        this._fulfillmentHandler0 = domain === null ? fulfill : util.domainBind(domain, fulfill);\n      }\n\n      if (typeof reject === \"function\") {\n        this._rejectionHandler0 = domain === null ? reject : util.domainBind(domain, reject);\n      }\n    } else {\n      var base = index * 4 - 4;\n      this[base + 2] = promise;\n      this[base + 3] = receiver;\n\n      if (typeof fulfill === \"function\") {\n        this[base + 0] = domain === null ? fulfill : util.domainBind(domain, fulfill);\n      }\n\n      if (typeof reject === \"function\") {\n        this[base + 1] = domain === null ? reject : util.domainBind(domain, reject);\n      }\n    }\n\n    this._setLength(index + 1);\n\n    return index;\n  };\n\n  Promise.prototype._proxy = function (proxyable, arg) {\n    this._addCallbacks(undefined, undefined, arg, proxyable, null);\n  };\n\n  Promise.prototype._resolveCallback = function (value, shouldBind) {\n    if ((this._bitField & 117506048) !== 0) return;\n    if (value === this) return this._rejectCallback(makeSelfResolutionError(), false);\n    var maybePromise = tryConvertToPromise(value, this);\n    if (!(maybePromise instanceof Promise)) return this._fulfill(value);\n    if (shouldBind) this._propagateFrom(maybePromise, 2);\n\n    var promise = maybePromise._target();\n\n    if (promise === this) {\n      this._reject(makeSelfResolutionError());\n\n      return;\n    }\n\n    var bitField = promise._bitField;\n\n    if ((bitField & 50397184) === 0) {\n      var len = this._length();\n\n      if (len > 0) promise._migrateCallback0(this);\n\n      for (var i = 1; i < len; ++i) {\n        promise._migrateCallbackAt(this, i);\n      }\n\n      this._setFollowing();\n\n      this._setLength(0);\n\n      this._setFollowee(promise);\n    } else if ((bitField & 33554432) !== 0) {\n      this._fulfill(promise._value());\n    } else if ((bitField & 16777216) !== 0) {\n      this._reject(promise._reason());\n    } else {\n      var reason = new CancellationError(\"late cancellation observer\");\n\n      promise._attachExtraTrace(reason);\n\n      this._reject(reason);\n    }\n  };\n\n  Promise.prototype._rejectCallback = function (reason, synchronous, ignoreNonErrorWarnings) {\n    var trace = util.ensureErrorObject(reason);\n    var hasStack = trace === reason;\n\n    if (!hasStack && !ignoreNonErrorWarnings && debug.warnings()) {\n      var message = \"a promise was rejected with a non-error: \" + util.classString(reason);\n\n      this._warn(message, true);\n    }\n\n    this._attachExtraTrace(trace, synchronous ? hasStack : false);\n\n    this._reject(reason);\n  };\n\n  Promise.prototype._resolveFromExecutor = function (executor) {\n    var promise = this;\n\n    this._captureStackTrace();\n\n    this._pushContext();\n\n    var synchronous = true;\n\n    var r = this._execute(executor, function (value) {\n      promise._resolveCallback(value);\n    }, function (reason) {\n      promise._rejectCallback(reason, synchronous);\n    });\n\n    synchronous = false;\n\n    this._popContext();\n\n    if (r !== undefined) {\n      promise._rejectCallback(r, true);\n    }\n  };\n\n  Promise.prototype._settlePromiseFromHandler = function (handler, receiver, value, promise) {\n    var bitField = promise._bitField;\n    if ((bitField & 65536) !== 0) return;\n\n    promise._pushContext();\n\n    var x;\n\n    if (receiver === APPLY) {\n      if (!value || typeof value.length !== \"number\") {\n        x = errorObj;\n        x.e = new TypeError(\"cannot .spread() a non-array: \" + util.classString(value));\n      } else {\n        x = tryCatch(handler).apply(this._boundValue(), value);\n      }\n    } else {\n      x = tryCatch(handler).call(receiver, value);\n    }\n\n    var promiseCreated = promise._popContext();\n\n    bitField = promise._bitField;\n    if ((bitField & 65536) !== 0) return;\n\n    if (x === NEXT_FILTER) {\n      promise._reject(value);\n    } else if (x === errorObj) {\n      promise._rejectCallback(x.e, false);\n    } else {\n      debug.checkForgottenReturns(x, promiseCreated, \"\", promise, this);\n\n      promise._resolveCallback(x);\n    }\n  };\n\n  Promise.prototype._target = function () {\n    var ret = this;\n\n    while (ret._isFollowing()) {\n      ret = ret._followee();\n    }\n\n    return ret;\n  };\n\n  Promise.prototype._followee = function () {\n    return this._rejectionHandler0;\n  };\n\n  Promise.prototype._setFollowee = function (promise) {\n    this._rejectionHandler0 = promise;\n  };\n\n  Promise.prototype._settlePromise = function (promise, handler, receiver, value) {\n    var isPromise = promise instanceof Promise;\n    var bitField = this._bitField;\n    var asyncGuaranteed = (bitField & 134217728) !== 0;\n\n    if ((bitField & 65536) !== 0) {\n      if (isPromise) promise._invokeInternalOnCancel();\n\n      if (receiver instanceof PassThroughHandlerContext && receiver.isFinallyHandler()) {\n        receiver.cancelPromise = promise;\n\n        if (tryCatch(handler).call(receiver, value) === errorObj) {\n          promise._reject(errorObj.e);\n        }\n      } else if (handler === reflectHandler) {\n        promise._fulfill(reflectHandler.call(receiver));\n      } else if (receiver instanceof Proxyable) {\n        receiver._promiseCancelled(promise);\n      } else if (isPromise || promise instanceof PromiseArray) {\n        promise._cancel();\n      } else {\n        receiver.cancel();\n      }\n    } else if (typeof handler === \"function\") {\n      if (!isPromise) {\n        handler.call(receiver, value, promise);\n      } else {\n        if (asyncGuaranteed) promise._setAsyncGuaranteed();\n\n        this._settlePromiseFromHandler(handler, receiver, value, promise);\n      }\n    } else if (receiver instanceof Proxyable) {\n      if (!receiver._isResolved()) {\n        if ((bitField & 33554432) !== 0) {\n          receiver._promiseFulfilled(value, promise);\n        } else {\n          receiver._promiseRejected(value, promise);\n        }\n      }\n    } else if (isPromise) {\n      if (asyncGuaranteed) promise._setAsyncGuaranteed();\n\n      if ((bitField & 33554432) !== 0) {\n        promise._fulfill(value);\n      } else {\n        promise._reject(value);\n      }\n    }\n  };\n\n  Promise.prototype._settlePromiseLateCancellationObserver = function (ctx) {\n    var handler = ctx.handler;\n    var promise = ctx.promise;\n    var receiver = ctx.receiver;\n    var value = ctx.value;\n\n    if (typeof handler === \"function\") {\n      if (!(promise instanceof Promise)) {\n        handler.call(receiver, value, promise);\n      } else {\n        this._settlePromiseFromHandler(handler, receiver, value, promise);\n      }\n    } else if (promise instanceof Promise) {\n      promise._reject(value);\n    }\n  };\n\n  Promise.prototype._settlePromiseCtx = function (ctx) {\n    this._settlePromise(ctx.promise, ctx.handler, ctx.receiver, ctx.value);\n  };\n\n  Promise.prototype._settlePromise0 = function (handler, value, bitField) {\n    var promise = this._promise0;\n\n    var receiver = this._receiverAt(0);\n\n    this._promise0 = undefined;\n    this._receiver0 = undefined;\n\n    this._settlePromise(promise, handler, receiver, value);\n  };\n\n  Promise.prototype._clearCallbackDataAtIndex = function (index) {\n    var base = index * 4 - 4;\n    this[base + 2] = this[base + 3] = this[base + 0] = this[base + 1] = undefined;\n  };\n\n  Promise.prototype._fulfill = function (value) {\n    var bitField = this._bitField;\n    if ((bitField & 117506048) >>> 16) return;\n\n    if (value === this) {\n      var err = makeSelfResolutionError();\n\n      this._attachExtraTrace(err);\n\n      return this._reject(err);\n    }\n\n    this._setFulfilled();\n\n    this._rejectionHandler0 = value;\n\n    if ((bitField & 65535) > 0) {\n      if ((bitField & 134217728) !== 0) {\n        this._settlePromises();\n      } else {\n        async.settlePromises(this);\n      }\n    }\n  };\n\n  Promise.prototype._reject = function (reason) {\n    var bitField = this._bitField;\n    if ((bitField & 117506048) >>> 16) return;\n\n    this._setRejected();\n\n    this._fulfillmentHandler0 = reason;\n\n    if (this._isFinal()) {\n      return async.fatalError(reason, util.isNode);\n    }\n\n    if ((bitField & 65535) > 0) {\n      async.settlePromises(this);\n    } else {\n      this._ensurePossibleRejectionHandled();\n    }\n  };\n\n  Promise.prototype._fulfillPromises = function (len, value) {\n    for (var i = 1; i < len; i++) {\n      var handler = this._fulfillmentHandlerAt(i);\n\n      var promise = this._promiseAt(i);\n\n      var receiver = this._receiverAt(i);\n\n      this._clearCallbackDataAtIndex(i);\n\n      this._settlePromise(promise, handler, receiver, value);\n    }\n  };\n\n  Promise.prototype._rejectPromises = function (len, reason) {\n    for (var i = 1; i < len; i++) {\n      var handler = this._rejectionHandlerAt(i);\n\n      var promise = this._promiseAt(i);\n\n      var receiver = this._receiverAt(i);\n\n      this._clearCallbackDataAtIndex(i);\n\n      this._settlePromise(promise, handler, receiver, reason);\n    }\n  };\n\n  Promise.prototype._settlePromises = function () {\n    var bitField = this._bitField;\n    var len = bitField & 65535;\n\n    if (len > 0) {\n      if ((bitField & 16842752) !== 0) {\n        var reason = this._fulfillmentHandler0;\n\n        this._settlePromise0(this._rejectionHandler0, reason, bitField);\n\n        this._rejectPromises(len, reason);\n      } else {\n        var value = this._rejectionHandler0;\n\n        this._settlePromise0(this._fulfillmentHandler0, value, bitField);\n\n        this._fulfillPromises(len, value);\n      }\n\n      this._setLength(0);\n    }\n\n    this._clearCancellationData();\n  };\n\n  Promise.prototype._settledValue = function () {\n    var bitField = this._bitField;\n\n    if ((bitField & 33554432) !== 0) {\n      return this._rejectionHandler0;\n    } else if ((bitField & 16777216) !== 0) {\n      return this._fulfillmentHandler0;\n    }\n  };\n\n  function deferResolve(v) {\n    this.promise._resolveCallback(v);\n  }\n\n  function deferReject(v) {\n    this.promise._rejectCallback(v, false);\n  }\n\n  Promise.defer = Promise.pending = function () {\n    debug.deprecated(\"Promise.defer\", \"new Promise\");\n    var promise = new Promise(INTERNAL);\n    return {\n      promise: promise,\n      resolve: deferResolve,\n      reject: deferReject\n    };\n  };\n\n  util.notEnumerableProp(Promise, \"_makeSelfResolutionError\", makeSelfResolutionError);\n\n  require(\"./method\")(Promise, INTERNAL, tryConvertToPromise, apiRejection, debug);\n\n  require(\"./bind\")(Promise, INTERNAL, tryConvertToPromise, debug);\n\n  require(\"./cancel\")(Promise, PromiseArray, apiRejection, debug);\n\n  require(\"./direct_resolve\")(Promise);\n\n  require(\"./synchronous_inspection\")(Promise);\n\n  require(\"./join\")(Promise, PromiseArray, tryConvertToPromise, INTERNAL, async, getDomain);\n\n  Promise.Promise = Promise;\n  Promise.version = \"3.4.7\";\n\n  require('./map.js')(Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL, debug);\n\n  require('./call_get.js')(Promise);\n\n  require('./using.js')(Promise, apiRejection, tryConvertToPromise, createContext, INTERNAL, debug);\n\n  require('./timers.js')(Promise, INTERNAL, debug);\n\n  require('./generators.js')(Promise, apiRejection, INTERNAL, tryConvertToPromise, Proxyable, debug);\n\n  require('./nodeify.js')(Promise);\n\n  require('./promisify.js')(Promise, INTERNAL);\n\n  require('./props.js')(Promise, PromiseArray, tryConvertToPromise, apiRejection);\n\n  require('./race.js')(Promise, INTERNAL, tryConvertToPromise, apiRejection);\n\n  require('./reduce.js')(Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL, debug);\n\n  require('./settle.js')(Promise, PromiseArray, debug);\n\n  require('./some.js')(Promise, PromiseArray, apiRejection);\n\n  require('./filter.js')(Promise, INTERNAL);\n\n  require('./each.js')(Promise, INTERNAL);\n\n  require('./any.js')(Promise);\n\n  util.toFastProperties(Promise);\n  util.toFastProperties(Promise.prototype);\n\n  function fillTypes(value) {\n    var p = new Promise(INTERNAL);\n    p._fulfillmentHandler0 = value;\n    p._rejectionHandler0 = value;\n    p._promise0 = value;\n    p._receiver0 = value;\n  } // Complete slack tracking, opt out of field-type tracking and           \n  // stabilize map                                                         \n\n\n  fillTypes({\n    a: 1\n  });\n  fillTypes({\n    b: 2\n  });\n  fillTypes({\n    c: 3\n  });\n  fillTypes(1);\n  fillTypes(function () {});\n  fillTypes(undefined);\n  fillTypes(false);\n  fillTypes(new Promise(INTERNAL));\n  debug.setBounds(Async.firstLineError, util.lastLineError);\n  return Promise;\n};","map":{"version":3,"sources":["C:/Users/Carlos/Desktop/Coding/doc-to-html/node_modules/bluebird/js/release/promise.js"],"names":["module","exports","makeSelfResolutionError","TypeError","reflectHandler","Promise","PromiseInspection","_target","apiRejection","msg","reject","Proxyable","UNDEFINED_BINDING","util","require","getDomain","isNode","ret","process","domain","undefined","notEnumerableProp","es5","Async","async","defineProperty","value","errors","RangeError","CancellationError","TimeoutError","OperationalError","RejectionError","AggregateError","INTERNAL","APPLY","NEXT_FILTER","tryConvertToPromise","PromiseArray","Context","createContext","create","debug","CapturedTrace","PassThroughHandlerContext","catchFilter","nodebackForPromise","errorObj","tryCatch","check","self","executor","classString","constructor","_bitField","_fulfillmentHandler0","_rejectionHandler0","_promise0","_receiver0","_resolveFromExecutor","_promiseCreated","_fireEvent","prototype","toString","caught","fn","len","arguments","length","catchInstances","Array","j","i","item","isObject","then","reflect","_then","didFulfill","didReject","warnings","_warn","done","promise","_setIsFinal","spread","all","toJSON","isFulfilled","isRejected","fulfillmentValue","rejectionReason","reason","error","originatesFromRejection","getNewLibraryCopy","is","val","fromNode","fromCallback","_captureStackTrace","multiArgs","Object","result","_rejectCallback","e","_isFateSealed","_setAsyncGuaranteed","promises","cast","obj","_setFulfilled","resolve","fulfilled","rejected","setScheduler","_","receiver","internalData","haveInternalData","target","bitField","_propagateFrom","_boundValue","_boundTo","handler","settler","_settlePromiseCtx","_unsetRejectionIsUnhandled","_settlePromiseLateCancellationObserver","_attachExtraTrace","invoke","domainBind","_addCallbacks","_length","_isFollowing","_setLength","_setRejected","_setFollowing","_isFinal","_unsetCancelled","_setCancelled","_setWillBeCancelled","hasCustomScheduler","_receiverAt","index","_isBound","_promiseAt","_fulfillmentHandlerAt","_rejectionHandlerAt","_migrateCallback0","follower","fulfill","_migrateCallbackAt","base","_proxy","proxyable","arg","_resolveCallback","shouldBind","maybePromise","_fulfill","_reject","_setFollowee","_value","_reason","synchronous","ignoreNonErrorWarnings","trace","ensureErrorObject","hasStack","message","_pushContext","r","_execute","_popContext","_settlePromiseFromHandler","x","apply","call","promiseCreated","checkForgottenReturns","_followee","_settlePromise","isPromise","asyncGuaranteed","_invokeInternalOnCancel","isFinallyHandler","cancelPromise","_promiseCancelled","_cancel","cancel","_isResolved","_promiseFulfilled","_promiseRejected","ctx","_settlePromise0","_clearCallbackDataAtIndex","err","_settlePromises","settlePromises","fatalError","_ensurePossibleRejectionHandled","_fulfillPromises","_rejectPromises","_clearCancellationData","_settledValue","deferResolve","v","deferReject","defer","pending","deprecated","version","toFastProperties","fillTypes","p","a","b","c","setBounds","firstLineError","lastLineError"],"mappings":"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","sourcesContent":["\"use strict\";\nmodule.exports = function() {\nvar makeSelfResolutionError = function () {\n    return new TypeError(\"circular promise resolution chain\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n};\nvar reflectHandler = function() {\n    return new Promise.PromiseInspection(this._target());\n};\nvar apiRejection = function(msg) {\n    return Promise.reject(new TypeError(msg));\n};\nfunction Proxyable() {}\nvar UNDEFINED_BINDING = {};\nvar util = require(\"./util\");\n\nvar getDomain;\nif (util.isNode) {\n    getDomain = function() {\n        var ret = process.domain;\n        if (ret === undefined) ret = null;\n        return ret;\n    };\n} else {\n    getDomain = function() {\n        return null;\n    };\n}\nutil.notEnumerableProp(Promise, \"_getDomain\", getDomain);\n\nvar es5 = require(\"./es5\");\nvar Async = require(\"./async\");\nvar async = new Async();\nes5.defineProperty(Promise, \"_async\", {value: async});\nvar errors = require(\"./errors\");\nvar TypeError = Promise.TypeError = errors.TypeError;\nPromise.RangeError = errors.RangeError;\nvar CancellationError = Promise.CancellationError = errors.CancellationError;\nPromise.TimeoutError = errors.TimeoutError;\nPromise.OperationalError = errors.OperationalError;\nPromise.RejectionError = errors.OperationalError;\nPromise.AggregateError = errors.AggregateError;\nvar INTERNAL = function(){};\nvar APPLY = {};\nvar NEXT_FILTER = {};\nvar tryConvertToPromise = require(\"./thenables\")(Promise, INTERNAL);\nvar PromiseArray =\n    require(\"./promise_array\")(Promise, INTERNAL,\n                               tryConvertToPromise, apiRejection, Proxyable);\nvar Context = require(\"./context\")(Promise);\n /*jshint unused:false*/\nvar createContext = Context.create;\nvar debug = require(\"./debuggability\")(Promise, Context);\nvar CapturedTrace = debug.CapturedTrace;\nvar PassThroughHandlerContext =\n    require(\"./finally\")(Promise, tryConvertToPromise);\nvar catchFilter = require(\"./catch_filter\")(NEXT_FILTER);\nvar nodebackForPromise = require(\"./nodeback\");\nvar errorObj = util.errorObj;\nvar tryCatch = util.tryCatch;\nfunction check(self, executor) {\n    if (typeof executor !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(executor));\n    }\n    if (self.constructor !== Promise) {\n        throw new TypeError(\"the promise constructor cannot be invoked directly\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n}\n\nfunction Promise(executor) {\n    this._bitField = 0;\n    this._fulfillmentHandler0 = undefined;\n    this._rejectionHandler0 = undefined;\n    this._promise0 = undefined;\n    this._receiver0 = undefined;\n    if (executor !== INTERNAL) {\n        check(this, executor);\n        this._resolveFromExecutor(executor);\n    }\n    this._promiseCreated();\n    this._fireEvent(\"promiseCreated\", this);\n}\n\nPromise.prototype.toString = function () {\n    return \"[object Promise]\";\n};\n\nPromise.prototype.caught = Promise.prototype[\"catch\"] = function (fn) {\n    var len = arguments.length;\n    if (len > 1) {\n        var catchInstances = new Array(len - 1),\n            j = 0, i;\n        for (i = 0; i < len - 1; ++i) {\n            var item = arguments[i];\n            if (util.isObject(item)) {\n                catchInstances[j++] = item;\n            } else {\n                return apiRejection(\"expecting an object but got \" +\n                    \"A catch statement predicate \" + util.classString(item));\n            }\n        }\n        catchInstances.length = j;\n        fn = arguments[i];\n        return this.then(undefined, catchFilter(catchInstances, fn, this));\n    }\n    return this.then(undefined, fn);\n};\n\nPromise.prototype.reflect = function () {\n    return this._then(reflectHandler,\n        reflectHandler, undefined, this, undefined);\n};\n\nPromise.prototype.then = function (didFulfill, didReject) {\n    if (debug.warnings() && arguments.length > 0 &&\n        typeof didFulfill !== \"function\" &&\n        typeof didReject !== \"function\") {\n        var msg = \".then() only accepts functions but was passed: \" +\n                util.classString(didFulfill);\n        if (arguments.length > 1) {\n            msg += \", \" + util.classString(didReject);\n        }\n        this._warn(msg);\n    }\n    return this._then(didFulfill, didReject, undefined, undefined, undefined);\n};\n\nPromise.prototype.done = function (didFulfill, didReject) {\n    var promise =\n        this._then(didFulfill, didReject, undefined, undefined, undefined);\n    promise._setIsFinal();\n};\n\nPromise.prototype.spread = function (fn) {\n    if (typeof fn !== \"function\") {\n        return apiRejection(\"expecting a function but got \" + util.classString(fn));\n    }\n    return this.all()._then(fn, undefined, undefined, APPLY, undefined);\n};\n\nPromise.prototype.toJSON = function () {\n    var ret = {\n        isFulfilled: false,\n        isRejected: false,\n        fulfillmentValue: undefined,\n        rejectionReason: undefined\n    };\n    if (this.isFulfilled()) {\n        ret.fulfillmentValue = this.value();\n        ret.isFulfilled = true;\n    } else if (this.isRejected()) {\n        ret.rejectionReason = this.reason();\n        ret.isRejected = true;\n    }\n    return ret;\n};\n\nPromise.prototype.all = function () {\n    if (arguments.length > 0) {\n        this._warn(\".all() was passed arguments but it does not take any\");\n    }\n    return new PromiseArray(this).promise();\n};\n\nPromise.prototype.error = function (fn) {\n    return this.caught(util.originatesFromRejection, fn);\n};\n\nPromise.getNewLibraryCopy = module.exports;\n\nPromise.is = function (val) {\n    return val instanceof Promise;\n};\n\nPromise.fromNode = Promise.fromCallback = function(fn) {\n    var ret = new Promise(INTERNAL);\n    ret._captureStackTrace();\n    var multiArgs = arguments.length > 1 ? !!Object(arguments[1]).multiArgs\n                                         : false;\n    var result = tryCatch(fn)(nodebackForPromise(ret, multiArgs));\n    if (result === errorObj) {\n        ret._rejectCallback(result.e, true);\n    }\n    if (!ret._isFateSealed()) ret._setAsyncGuaranteed();\n    return ret;\n};\n\nPromise.all = function (promises) {\n    return new PromiseArray(promises).promise();\n};\n\nPromise.cast = function (obj) {\n    var ret = tryConvertToPromise(obj);\n    if (!(ret instanceof Promise)) {\n        ret = new Promise(INTERNAL);\n        ret._captureStackTrace();\n        ret._setFulfilled();\n        ret._rejectionHandler0 = obj;\n    }\n    return ret;\n};\n\nPromise.resolve = Promise.fulfilled = Promise.cast;\n\nPromise.reject = Promise.rejected = function (reason) {\n    var ret = new Promise(INTERNAL);\n    ret._captureStackTrace();\n    ret._rejectCallback(reason, true);\n    return ret;\n};\n\nPromise.setScheduler = function(fn) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    return async.setScheduler(fn);\n};\n\nPromise.prototype._then = function (\n    didFulfill,\n    didReject,\n    _,    receiver,\n    internalData\n) {\n    var haveInternalData = internalData !== undefined;\n    var promise = haveInternalData ? internalData : new Promise(INTERNAL);\n    var target = this._target();\n    var bitField = target._bitField;\n\n    if (!haveInternalData) {\n        promise._propagateFrom(this, 3);\n        promise._captureStackTrace();\n        if (receiver === undefined &&\n            ((this._bitField & 2097152) !== 0)) {\n            if (!((bitField & 50397184) === 0)) {\n                receiver = this._boundValue();\n            } else {\n                receiver = target === this ? undefined : this._boundTo;\n            }\n        }\n        this._fireEvent(\"promiseChained\", this, promise);\n    }\n\n    var domain = getDomain();\n    if (!((bitField & 50397184) === 0)) {\n        var handler, value, settler = target._settlePromiseCtx;\n        if (((bitField & 33554432) !== 0)) {\n            value = target._rejectionHandler0;\n            handler = didFulfill;\n        } else if (((bitField & 16777216) !== 0)) {\n            value = target._fulfillmentHandler0;\n            handler = didReject;\n            target._unsetRejectionIsUnhandled();\n        } else {\n            settler = target._settlePromiseLateCancellationObserver;\n            value = new CancellationError(\"late cancellation observer\");\n            target._attachExtraTrace(value);\n            handler = didReject;\n        }\n\n        async.invoke(settler, target, {\n            handler: domain === null ? handler\n                : (typeof handler === \"function\" &&\n                    util.domainBind(domain, handler)),\n            promise: promise,\n            receiver: receiver,\n            value: value\n        });\n    } else {\n        target._addCallbacks(didFulfill, didReject, promise, receiver, domain);\n    }\n\n    return promise;\n};\n\nPromise.prototype._length = function () {\n    return this._bitField & 65535;\n};\n\nPromise.prototype._isFateSealed = function () {\n    return (this._bitField & 117506048) !== 0;\n};\n\nPromise.prototype._isFollowing = function () {\n    return (this._bitField & 67108864) === 67108864;\n};\n\nPromise.prototype._setLength = function (len) {\n    this._bitField = (this._bitField & -65536) |\n        (len & 65535);\n};\n\nPromise.prototype._setFulfilled = function () {\n    this._bitField = this._bitField | 33554432;\n    this._fireEvent(\"promiseFulfilled\", this);\n};\n\nPromise.prototype._setRejected = function () {\n    this._bitField = this._bitField | 16777216;\n    this._fireEvent(\"promiseRejected\", this);\n};\n\nPromise.prototype._setFollowing = function () {\n    this._bitField = this._bitField | 67108864;\n    this._fireEvent(\"promiseResolved\", this);\n};\n\nPromise.prototype._setIsFinal = function () {\n    this._bitField = this._bitField | 4194304;\n};\n\nPromise.prototype._isFinal = function () {\n    return (this._bitField & 4194304) > 0;\n};\n\nPromise.prototype._unsetCancelled = function() {\n    this._bitField = this._bitField & (~65536);\n};\n\nPromise.prototype._setCancelled = function() {\n    this._bitField = this._bitField | 65536;\n    this._fireEvent(\"promiseCancelled\", this);\n};\n\nPromise.prototype._setWillBeCancelled = function() {\n    this._bitField = this._bitField | 8388608;\n};\n\nPromise.prototype._setAsyncGuaranteed = function() {\n    if (async.hasCustomScheduler()) return;\n    this._bitField = this._bitField | 134217728;\n};\n\nPromise.prototype._receiverAt = function (index) {\n    var ret = index === 0 ? this._receiver0 : this[\n            index * 4 - 4 + 3];\n    if (ret === UNDEFINED_BINDING) {\n        return undefined;\n    } else if (ret === undefined && this._isBound()) {\n        return this._boundValue();\n    }\n    return ret;\n};\n\nPromise.prototype._promiseAt = function (index) {\n    return this[\n            index * 4 - 4 + 2];\n};\n\nPromise.prototype._fulfillmentHandlerAt = function (index) {\n    return this[\n            index * 4 - 4 + 0];\n};\n\nPromise.prototype._rejectionHandlerAt = function (index) {\n    return this[\n            index * 4 - 4 + 1];\n};\n\nPromise.prototype._boundValue = function() {};\n\nPromise.prototype._migrateCallback0 = function (follower) {\n    var bitField = follower._bitField;\n    var fulfill = follower._fulfillmentHandler0;\n    var reject = follower._rejectionHandler0;\n    var promise = follower._promise0;\n    var receiver = follower._receiverAt(0);\n    if (receiver === undefined) receiver = UNDEFINED_BINDING;\n    this._addCallbacks(fulfill, reject, promise, receiver, null);\n};\n\nPromise.prototype._migrateCallbackAt = function (follower, index) {\n    var fulfill = follower._fulfillmentHandlerAt(index);\n    var reject = follower._rejectionHandlerAt(index);\n    var promise = follower._promiseAt(index);\n    var receiver = follower._receiverAt(index);\n    if (receiver === undefined) receiver = UNDEFINED_BINDING;\n    this._addCallbacks(fulfill, reject, promise, receiver, null);\n};\n\nPromise.prototype._addCallbacks = function (\n    fulfill,\n    reject,\n    promise,\n    receiver,\n    domain\n) {\n    var index = this._length();\n\n    if (index >= 65535 - 4) {\n        index = 0;\n        this._setLength(0);\n    }\n\n    if (index === 0) {\n        this._promise0 = promise;\n        this._receiver0 = receiver;\n        if (typeof fulfill === \"function\") {\n            this._fulfillmentHandler0 =\n                domain === null ? fulfill : util.domainBind(domain, fulfill);\n        }\n        if (typeof reject === \"function\") {\n            this._rejectionHandler0 =\n                domain === null ? reject : util.domainBind(domain, reject);\n        }\n    } else {\n        var base = index * 4 - 4;\n        this[base + 2] = promise;\n        this[base + 3] = receiver;\n        if (typeof fulfill === \"function\") {\n            this[base + 0] =\n                domain === null ? fulfill : util.domainBind(domain, fulfill);\n        }\n        if (typeof reject === \"function\") {\n            this[base + 1] =\n                domain === null ? reject : util.domainBind(domain, reject);\n        }\n    }\n    this._setLength(index + 1);\n    return index;\n};\n\nPromise.prototype._proxy = function (proxyable, arg) {\n    this._addCallbacks(undefined, undefined, arg, proxyable, null);\n};\n\nPromise.prototype._resolveCallback = function(value, shouldBind) {\n    if (((this._bitField & 117506048) !== 0)) return;\n    if (value === this)\n        return this._rejectCallback(makeSelfResolutionError(), false);\n    var maybePromise = tryConvertToPromise(value, this);\n    if (!(maybePromise instanceof Promise)) return this._fulfill(value);\n\n    if (shouldBind) this._propagateFrom(maybePromise, 2);\n\n    var promise = maybePromise._target();\n\n    if (promise === this) {\n        this._reject(makeSelfResolutionError());\n        return;\n    }\n\n    var bitField = promise._bitField;\n    if (((bitField & 50397184) === 0)) {\n        var len = this._length();\n        if (len > 0) promise._migrateCallback0(this);\n        for (var i = 1; i < len; ++i) {\n            promise._migrateCallbackAt(this, i);\n        }\n        this._setFollowing();\n        this._setLength(0);\n        this._setFollowee(promise);\n    } else if (((bitField & 33554432) !== 0)) {\n        this._fulfill(promise._value());\n    } else if (((bitField & 16777216) !== 0)) {\n        this._reject(promise._reason());\n    } else {\n        var reason = new CancellationError(\"late cancellation observer\");\n        promise._attachExtraTrace(reason);\n        this._reject(reason);\n    }\n};\n\nPromise.prototype._rejectCallback =\nfunction(reason, synchronous, ignoreNonErrorWarnings) {\n    var trace = util.ensureErrorObject(reason);\n    var hasStack = trace === reason;\n    if (!hasStack && !ignoreNonErrorWarnings && debug.warnings()) {\n        var message = \"a promise was rejected with a non-error: \" +\n            util.classString(reason);\n        this._warn(message, true);\n    }\n    this._attachExtraTrace(trace, synchronous ? hasStack : false);\n    this._reject(reason);\n};\n\nPromise.prototype._resolveFromExecutor = function (executor) {\n    var promise = this;\n    this._captureStackTrace();\n    this._pushContext();\n    var synchronous = true;\n    var r = this._execute(executor, function(value) {\n        promise._resolveCallback(value);\n    }, function (reason) {\n        promise._rejectCallback(reason, synchronous);\n    });\n    synchronous = false;\n    this._popContext();\n\n    if (r !== undefined) {\n        promise._rejectCallback(r, true);\n    }\n};\n\nPromise.prototype._settlePromiseFromHandler = function (\n    handler, receiver, value, promise\n) {\n    var bitField = promise._bitField;\n    if (((bitField & 65536) !== 0)) return;\n    promise._pushContext();\n    var x;\n    if (receiver === APPLY) {\n        if (!value || typeof value.length !== \"number\") {\n            x = errorObj;\n            x.e = new TypeError(\"cannot .spread() a non-array: \" +\n                                    util.classString(value));\n        } else {\n            x = tryCatch(handler).apply(this._boundValue(), value);\n        }\n    } else {\n        x = tryCatch(handler).call(receiver, value);\n    }\n    var promiseCreated = promise._popContext();\n    bitField = promise._bitField;\n    if (((bitField & 65536) !== 0)) return;\n\n    if (x === NEXT_FILTER) {\n        promise._reject(value);\n    } else if (x === errorObj) {\n        promise._rejectCallback(x.e, false);\n    } else {\n        debug.checkForgottenReturns(x, promiseCreated, \"\",  promise, this);\n        promise._resolveCallback(x);\n    }\n};\n\nPromise.prototype._target = function() {\n    var ret = this;\n    while (ret._isFollowing()) ret = ret._followee();\n    return ret;\n};\n\nPromise.prototype._followee = function() {\n    return this._rejectionHandler0;\n};\n\nPromise.prototype._setFollowee = function(promise) {\n    this._rejectionHandler0 = promise;\n};\n\nPromise.prototype._settlePromise = function(promise, handler, receiver, value) {\n    var isPromise = promise instanceof Promise;\n    var bitField = this._bitField;\n    var asyncGuaranteed = ((bitField & 134217728) !== 0);\n    if (((bitField & 65536) !== 0)) {\n        if (isPromise) promise._invokeInternalOnCancel();\n\n        if (receiver instanceof PassThroughHandlerContext &&\n            receiver.isFinallyHandler()) {\n            receiver.cancelPromise = promise;\n            if (tryCatch(handler).call(receiver, value) === errorObj) {\n                promise._reject(errorObj.e);\n            }\n        } else if (handler === reflectHandler) {\n            promise._fulfill(reflectHandler.call(receiver));\n        } else if (receiver instanceof Proxyable) {\n            receiver._promiseCancelled(promise);\n        } else if (isPromise || promise instanceof PromiseArray) {\n            promise._cancel();\n        } else {\n            receiver.cancel();\n        }\n    } else if (typeof handler === \"function\") {\n        if (!isPromise) {\n            handler.call(receiver, value, promise);\n        } else {\n            if (asyncGuaranteed) promise._setAsyncGuaranteed();\n            this._settlePromiseFromHandler(handler, receiver, value, promise);\n        }\n    } else if (receiver instanceof Proxyable) {\n        if (!receiver._isResolved()) {\n            if (((bitField & 33554432) !== 0)) {\n                receiver._promiseFulfilled(value, promise);\n            } else {\n                receiver._promiseRejected(value, promise);\n            }\n        }\n    } else if (isPromise) {\n        if (asyncGuaranteed) promise._setAsyncGuaranteed();\n        if (((bitField & 33554432) !== 0)) {\n            promise._fulfill(value);\n        } else {\n            promise._reject(value);\n        }\n    }\n};\n\nPromise.prototype._settlePromiseLateCancellationObserver = function(ctx) {\n    var handler = ctx.handler;\n    var promise = ctx.promise;\n    var receiver = ctx.receiver;\n    var value = ctx.value;\n    if (typeof handler === \"function\") {\n        if (!(promise instanceof Promise)) {\n            handler.call(receiver, value, promise);\n        } else {\n            this._settlePromiseFromHandler(handler, receiver, value, promise);\n        }\n    } else if (promise instanceof Promise) {\n        promise._reject(value);\n    }\n};\n\nPromise.prototype._settlePromiseCtx = function(ctx) {\n    this._settlePromise(ctx.promise, ctx.handler, ctx.receiver, ctx.value);\n};\n\nPromise.prototype._settlePromise0 = function(handler, value, bitField) {\n    var promise = this._promise0;\n    var receiver = this._receiverAt(0);\n    this._promise0 = undefined;\n    this._receiver0 = undefined;\n    this._settlePromise(promise, handler, receiver, value);\n};\n\nPromise.prototype._clearCallbackDataAtIndex = function(index) {\n    var base = index * 4 - 4;\n    this[base + 2] =\n    this[base + 3] =\n    this[base + 0] =\n    this[base + 1] = undefined;\n};\n\nPromise.prototype._fulfill = function (value) {\n    var bitField = this._bitField;\n    if (((bitField & 117506048) >>> 16)) return;\n    if (value === this) {\n        var err = makeSelfResolutionError();\n        this._attachExtraTrace(err);\n        return this._reject(err);\n    }\n    this._setFulfilled();\n    this._rejectionHandler0 = value;\n\n    if ((bitField & 65535) > 0) {\n        if (((bitField & 134217728) !== 0)) {\n            this._settlePromises();\n        } else {\n            async.settlePromises(this);\n        }\n    }\n};\n\nPromise.prototype._reject = function (reason) {\n    var bitField = this._bitField;\n    if (((bitField & 117506048) >>> 16)) return;\n    this._setRejected();\n    this._fulfillmentHandler0 = reason;\n\n    if (this._isFinal()) {\n        return async.fatalError(reason, util.isNode);\n    }\n\n    if ((bitField & 65535) > 0) {\n        async.settlePromises(this);\n    } else {\n        this._ensurePossibleRejectionHandled();\n    }\n};\n\nPromise.prototype._fulfillPromises = function (len, value) {\n    for (var i = 1; i < len; i++) {\n        var handler = this._fulfillmentHandlerAt(i);\n        var promise = this._promiseAt(i);\n        var receiver = this._receiverAt(i);\n        this._clearCallbackDataAtIndex(i);\n        this._settlePromise(promise, handler, receiver, value);\n    }\n};\n\nPromise.prototype._rejectPromises = function (len, reason) {\n    for (var i = 1; i < len; i++) {\n        var handler = this._rejectionHandlerAt(i);\n        var promise = this._promiseAt(i);\n        var receiver = this._receiverAt(i);\n        this._clearCallbackDataAtIndex(i);\n        this._settlePromise(promise, handler, receiver, reason);\n    }\n};\n\nPromise.prototype._settlePromises = function () {\n    var bitField = this._bitField;\n    var len = (bitField & 65535);\n\n    if (len > 0) {\n        if (((bitField & 16842752) !== 0)) {\n            var reason = this._fulfillmentHandler0;\n            this._settlePromise0(this._rejectionHandler0, reason, bitField);\n            this._rejectPromises(len, reason);\n        } else {\n            var value = this._rejectionHandler0;\n            this._settlePromise0(this._fulfillmentHandler0, value, bitField);\n            this._fulfillPromises(len, value);\n        }\n        this._setLength(0);\n    }\n    this._clearCancellationData();\n};\n\nPromise.prototype._settledValue = function() {\n    var bitField = this._bitField;\n    if (((bitField & 33554432) !== 0)) {\n        return this._rejectionHandler0;\n    } else if (((bitField & 16777216) !== 0)) {\n        return this._fulfillmentHandler0;\n    }\n};\n\nfunction deferResolve(v) {this.promise._resolveCallback(v);}\nfunction deferReject(v) {this.promise._rejectCallback(v, false);}\n\nPromise.defer = Promise.pending = function() {\n    debug.deprecated(\"Promise.defer\", \"new Promise\");\n    var promise = new Promise(INTERNAL);\n    return {\n        promise: promise,\n        resolve: deferResolve,\n        reject: deferReject\n    };\n};\n\nutil.notEnumerableProp(Promise,\n                       \"_makeSelfResolutionError\",\n                       makeSelfResolutionError);\n\nrequire(\"./method\")(Promise, INTERNAL, tryConvertToPromise, apiRejection,\n    debug);\nrequire(\"./bind\")(Promise, INTERNAL, tryConvertToPromise, debug);\nrequire(\"./cancel\")(Promise, PromiseArray, apiRejection, debug);\nrequire(\"./direct_resolve\")(Promise);\nrequire(\"./synchronous_inspection\")(Promise);\nrequire(\"./join\")(\n    Promise, PromiseArray, tryConvertToPromise, INTERNAL, async, getDomain);\nPromise.Promise = Promise;\nPromise.version = \"3.4.7\";\nrequire('./map.js')(Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL, debug);\nrequire('./call_get.js')(Promise);\nrequire('./using.js')(Promise, apiRejection, tryConvertToPromise, createContext, INTERNAL, debug);\nrequire('./timers.js')(Promise, INTERNAL, debug);\nrequire('./generators.js')(Promise, apiRejection, INTERNAL, tryConvertToPromise, Proxyable, debug);\nrequire('./nodeify.js')(Promise);\nrequire('./promisify.js')(Promise, INTERNAL);\nrequire('./props.js')(Promise, PromiseArray, tryConvertToPromise, apiRejection);\nrequire('./race.js')(Promise, INTERNAL, tryConvertToPromise, apiRejection);\nrequire('./reduce.js')(Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL, debug);\nrequire('./settle.js')(Promise, PromiseArray, debug);\nrequire('./some.js')(Promise, PromiseArray, apiRejection);\nrequire('./filter.js')(Promise, INTERNAL);\nrequire('./each.js')(Promise, INTERNAL);\nrequire('./any.js')(Promise);\n                                                         \n    util.toFastProperties(Promise);                                          \n    util.toFastProperties(Promise.prototype);                                \n    function fillTypes(value) {                                              \n        var p = new Promise(INTERNAL);                                       \n        p._fulfillmentHandler0 = value;                                      \n        p._rejectionHandler0 = value;                                        \n        p._promise0 = value;                                                 \n        p._receiver0 = value;                                                \n    }                                                                        \n    // Complete slack tracking, opt out of field-type tracking and           \n    // stabilize map                                                         \n    fillTypes({a: 1});                                                       \n    fillTypes({b: 2});                                                       \n    fillTypes({c: 3});                                                       \n    fillTypes(1);                                                            \n    fillTypes(function(){});                                                 \n    fillTypes(undefined);                                                    \n    fillTypes(false);                                                        \n    fillTypes(new Promise(INTERNAL));                                        \n    debug.setBounds(Async.firstLineError, util.lastLineError);               \n    return Promise;                                                          \n\n};\n"]},"metadata":{},"sourceType":"script"}